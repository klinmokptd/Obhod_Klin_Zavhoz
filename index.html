<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Анкета административно-хозяйственного обхода</title>
    <style>
        :root {
            --primary-color: #8B4513;
            --secondary-color: #CD853F;
            --light-color: #FAF0E6;
            --border-color: #ddd;
            --completed-color: #e6f7e6;
        }
        
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%238B4513' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E");
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--primary-color);
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.8rem;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.1rem;
            margin: 0;
            font-weight: bold;
        }
        
        .branch-info {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            line-height: 1.6;
        }
        
        .branch-name {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .branch-details {
            font-size: 1rem;
        }
        
        .timestamp {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .timestamp label {
            font-weight: bold;
        }
        
        .timestamp input {
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 1rem;
        }
        
        .auto-save-status {
            margin-left: auto;
            font-size: 0.9rem;
            color: #666;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .sections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .section {
            border: 1px solid var(--border-color);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .section.collapsed {
            max-height: 60px;
        }
        
        .section.expanded {
            max-height: 800px;
        }
        
        .section-header {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 15px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-header h2 {
            margin: 0;
            font-size: 1.1rem;
            flex: 1;
        }
        
        .section-content {
            padding: 15px;
            max-height: 600px;
            overflow-y: auto;
            display: none;
        }
        
        .section.expanded .section-content {
            display: block;
        }
        
        .question {
            margin-bottom: 15px;
            padding: 10px;
            border-left: 3px solid var(--secondary-color);
            background-color: #f9f9f9;
            transition: background-color 0.3s;
            position: relative;
        }
        
        .question.completed {
            background-color: var(--completed-color);
        }
        
        .question-text {
            margin-bottom: 10px;
            font-weight: 500;
            font-size: 1rem;
            padding-right: 50px;
        }
        
        .check-button {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .check-button.checked {
            background-color: #4CAF50;
            border-color: #4CAF50;
        }
        
        .check-button.checked::after {
            content: "✓";
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .comment {
            margin-top: 10px;
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            resize: none;
            min-height: 60px;
            font-size: 0.9rem;
            overflow: hidden;
            transition: height 0.2s;
        }
        
        .additional-info {
            margin-top: 10px;
            width: 100%;
            padding: 8px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            resize: none;
            min-height: 60px;
            font-size: 0.9rem;
            overflow: hidden;
            transition: height 0.2s;
        }
        
        .section-status {
            font-size: 0.8rem;
            background-color: rgba(255,255,255,0.2);
            padding: 3px 8px;
            border-radius: 12px;
            margin-left: 10px;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            margin-top: 30px;
            gap: 20px;
        }
        
        button {
            padding: 12px 30px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #6b3300;
        }
        
        .save-btn {
            background-color: #4CAF50;
        }
        
        .save-btn:hover {
            background-color: #3d8b40;
        }
        
        .export-btn {
            background-color: #ff9800;
        }
        
        .export-btn:hover {
            background-color: #e68900;
        }
        
        .clear-btn {
            background-color: #f44336;
        }
        
        .clear-btn:hover {
            background-color: #d32f2f;
        }
        
        @media (max-width: 768px) {
            .sections-grid {
                grid-template-columns: 1fr;
            }
            
            .section-header h2 {
                font-size: 1rem;
            }
            
            .controls {
                flex-direction: column;
            }
            
            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Анкета административно-хозяйственного обхода</h1>
            <p class="subtitle">с заведующим хозяйством</p>
        </header>
        
        <div class="branch-info">
            <div class="branch-name">ГБУЗ МО МОКПТД</div>
            <div class="branch-details">Филиал "Клинский"</div>
            <div class="branch-details">Клинское отделение</div>
        </div>
        
        <div class="timestamp">
            <label for="timestamp">Дата проверки:</label>
            <input type="date" id="timestamp" name="timestamp">
            <div class="auto-save-status" id="auto-save-status">Автосохранение включено</div>
        </div>
        
        <div class="progress-bar">
            <div class="progress" id="progress"></div>
        </div>
        
        <div class="sections-grid" id="sections-container">
            <!-- Секции будут сгенерированы автоматически -->
        </div>
        
        <div class="controls">
            <button id="save-btn" class="save-btn">Сохранить данные</button>
            <button id="export-btn" class="export-btn">Скачать Excel файл</button>
            <button id="clear-btn" class="clear-btn">Очистить форму</button>
        </div>
    </div>

    <script>
        // Полные данные анкеты
        const sections = [
            {
                title: "Входная группа детского отделения",
                questions: [
                    "Ступеньки, перила технически исправны, не требуют ремонта",
                    "Ступеньки и территория рядом посыпаны реагентом",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Покрытие дверей не требует покраски",
                    "Дверь в исправном состоянии (замки, доводчик, петли)",
                    "Санитарное состояние удовлетворительно (нет пыли, мусора, паутины)",
                    "Состояние мусорной урны удовлетворительное",
                    "Информация на входной группе соответствует нормативу",
                    "Освещение исправно",
                    "Кнопка вызова персонала работает",
                    "В наличии ведро с песком; совок привязан",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Контейнерная площадка",
                questions: [
                    "Общий порядок поддерживается",
                    "Территория рядом посыпана реагентом",
                    "Стены и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Информация соответствует нормативу",
                    "Доступ ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Лишние предметы отсутствуют",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Входная группа в мокротную",
                questions: [
                    "Ступеньки, перила технически исправны, не требуют ремонта",
                    "Ступеньки и территория рядом посыпаны реагентом",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Покрытие дверей не требует покраски",
                    "Дверь в исправном состоянии (замки, доводчик, петли)",
                    "Санитарное состояние удовлетворительно (нет пыли, мусора, паутины)",
                    "Состояние мусорной урны удовлетворительное",
                    "Информация соответствует нормативу",
                    "Освещение исправно",
                    "Наличие ведра с песком с привязанным совком",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Состояние фасадов здания",
                questions: [
                    "Окна и подоконники чистые",
                    "Фундамент (надземная часть) не требует ремонта",
                    "Окна цокольного этажа чистые",
                    "Защитные экраны чистые, не требуют покраски",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Газоны",
                questions: [
                    "Соответствуют нормативам",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Асфальтовое покрытие",
                questions: [
                    "Не требует ремонта/чистки",
                    "Обработано реагентом",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Входная группа взрослого отделения",
                questions: [
                    "Ступеньки, перила технически исправны, не требуют ремонта",
                    "Ступеньки и территория рядом посыпаны реагентом",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Покрытие дверей не требует покраски",
                    "Дверь в исправном состоянии (замки, доводчик, петли)",
                    "Санитарное состояние удовлетворительно (нет пыли, мусора, паутины)",
                    "Состояние мусорной урны удовлетворительное",
                    "Информация соответствует нормативу",
                    "Освещение исправно",
                    "Кнопка вызова персонала работает",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Входная группа в мокротную внутренняя часть",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Вывеска 'Выход' светится",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Помещение мокротной",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Рекреация цокольного этажа",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Склад",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Столовая",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Столовые приборы хранятся в отдельных контейнерах",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Гардероб",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Содержание шкафов соответствует регламенту",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Коридор цокольного этажа",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Предбанник туалета",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Страховочный ключ вставлен в замок",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Помещение туалета",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Кабинет заведующего отделением",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Кабинет заведующего филиалом",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Входная группа детского отделения (внутренняя часть)",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Вывеска 'Выход' светится",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Рекреация детского отделения",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Вывеска 'Выход' светится",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Кабинет педиатра",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Процедурный детский кабинет",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Архив",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Рекреация взрослого отделения",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Вывеска 'Выход' светится",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Процедурный кабинет взрослый",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Рентгенкабинет",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Кабинет старшей медицинской сестры",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Регистратура",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Работоспособность запирающего регистратуру устройства",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Кабинет приема врача 102",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Туалет для персонала",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы отсутствуют",
                    "Сантехника в исправном состоянии",
                    "Кнопка вызова персонала работает",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Кабинет приема врача 103",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Розетки и электропроводка исправны",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Входная группа взрослого отделения (внутренняя часть)",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Доступ в служебные помещения, шкафы ограничен",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы и мебель отсутствуют",
                    "Мебель в исправном состоянии",
                    "Вывеска 'Выход' светится",
                    "Кресло-каталка в исправном состоянии, чистая",
                    "Дополнительная информация"
                ],
                hasComment: true
            },
            {
                title: "Туалет для посетителей",
                questions: [
                    "Общий порядок поддерживается",
                    "Стены, окна и двери чистые",
                    "Напольное покрытие целое, ровное, не требует ремонта",
                    "Состояние потолка удовлетворительное",
                    "Стены не требуют косметического ремонта",
                    "Освещение яркое, исправно работает",
                    "Информация соответствуют нормам",
                    "Ленты на ступенях/порогах не требуют обновления",
                    "Двери в исправном состоянии (замки, доводчик, петли)",
                    "Выключатели чистые, подписанные",
                    "Лишние предметы отсутствуют",
                    "Сантехника в исправном состоянии",
                    "Кнопка вызова персонала работает",
                    "Поручни закреплены",
                    "Крючки для костылей закреплены",
                    "Дополнительная информация"
                ],
                hasComment: true
            }
        ];

        // Глобальные переменные
        let answers = {};
        let autoSaveInterval;
        let lastSaveTime = null;
        
        // Инициализация при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            // Установка текущей даты
            const now = new Date();
            const timestampInput = document.getElementById('timestamp');
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            
            timestampInput.value = `${year}-${month}-${day}`;
            
            // Генерация секций
            generateSections();
            
            // Обновление прогресс-бара
            updateProgressBar();
            
            // Обработчики событий для кнопок
            document.getElementById('save-btn').addEventListener('click', saveToLocalStorage);
            document.getElementById('export-btn').addEventListener('click', exportToExcel);
            document.getElementById('clear-btn').addEventListener('click', clearForm);
            
            // Загрузка сохраненных данных
            loadFromLocalStorage();
            
            // Запуск автосохранения
            startAutoSave();
            
            // Автоматическое увеличение полей комментариев
            setupAutoResizeTextareas();
        });
        
        // Настройка автоматического изменения размера textarea
        function setupAutoResizeTextareas() {
            document.querySelectorAll('.comment, .additional-info').forEach(textarea => {
                textarea.style.height = 'auto';
                textarea.style.height = (textarea.scrollHeight) + 'px';
                
                textarea.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = (this.scrollHeight) + 'px';
                });
            });
        }
        
        // Запуск автосохранения
        function startAutoSave() {
            autoSaveInterval = setInterval(() => {
                saveToLocalStorage(true);
            }, 3 * 60 * 1000);
        }
        
        // Генерация секций анкеты
        function generateSections() {
            const container = document.getElementById('sections-container');
            
            sections.forEach((section, index) => {
                const sectionElement = document.createElement('div');
                sectionElement.className = 'section collapsed';
                sectionElement.dataset.sectionIndex = index;
                
                // Заголовок секции
                const header = document.createElement('div');
                header.className = 'section-header';
                header.dataset.sectionIndex = index;
                
                const title = document.createElement('h2');
                title.textContent = section.title;
                
                const status = document.createElement('div');
                status.className = 'section-status';
                status.textContent = '0/' + section.questions.length;
                
                header.appendChild(title);
                header.appendChild(status);
                
                // Содержимое секции
                const content = document.createElement('div');
                content.className = 'section-content';
                
                section.questions.forEach((question, qIndex) => {
                    const questionElement = document.createElement('div');
                    questionElement.className = 'question';
                    questionElement.dataset.questionId = `${index}-${qIndex}`;
                    
                    const questionText = document.createElement('div');
                    questionText.className = 'question-text';
                    questionText.textContent = question;
                    
                    const checkButton = document.createElement('div');
                    checkButton.className = 'check-button';
                    checkButton.dataset.questionId = `${index}-${qIndex}`;
                    
                    questionElement.appendChild(questionText);
                    questionElement.appendChild(checkButton);
                    
                    // Поле для комментария
                    if (section.hasComment && question !== "Дополнительная информация") {
                        const comment = document.createElement('textarea');
                        comment.className = 'comment';
                        comment.placeholder = 'Комментарий (необязательно)';
                        comment.dataset.questionId = `${index}-${qIndex}`;
                        questionElement.appendChild(comment);
                    }
                    
                    // Поле для дополнительной информации
                    if (question === "Дополнительная информация") {
                        const additionalInfo = document.createElement('textarea');
                        additionalInfo.className = 'additional-info';
                        additionalInfo.placeholder = 'Дополнительная информация';
                        additionalInfo.dataset.questionId = `${index}-${qIndex}`;
                        questionElement.appendChild(additionalInfo);
                    }
                    
                    content.appendChild(questionElement);
                    
                    // Обработчик для кнопки проверки
                    checkButton.addEventListener('click', function() {
                        const isChecked = this.classList.contains('checked');
                        
                        if (isChecked) {
                            this.classList.remove('checked');
                            questionElement.classList.remove('completed');
                            saveAnswer(index, qIndex, 'Не проверено');
                        } else {
                            this.classList.add('checked');
                            questionElement.classList.add('completed');
                            saveAnswer(index, qIndex, 'Проверено');
                        }
                        
                        updateSectionStatus(index);
                        updateProgressBar();
                        saveToLocalStorage(true);
                    });
                    
                    // Обработчики для полей ввода
                    if (section.hasComment && question !== "Дополнительная информация") {
                        const comment = questionElement.querySelector('textarea');
                        comment.addEventListener('input', function() {
                            saveAnswer(index, qIndex, null, this.value);
                            saveToLocalStorage(true);
                        });
                    }
                    
                    if (question === "Дополнительная информация") {
                        const additionalInfo = questionElement.querySelector('textarea');
                        additionalInfo.addEventListener('input', function() {
                            saveAnswer(index, qIndex, null, null, this.value);
                            saveToLocalStorage(true);
                        });
                    }
                });
                
                sectionElement.appendChild(header);
                sectionElement.appendChild(content);
                
                // Обработчик для переключения секций
                header.addEventListener('click', function() {
                    const sectionIndex = this.dataset.sectionIndex;
                    const section = document.querySelector(`.section[data-section-index="${sectionIndex}"]`);
                    
                    if (section.classList.contains('collapsed')) {
                        document.querySelectorAll('.section').forEach(s => {
                            s.classList.remove('expanded');
                            s.classList.add('collapsed');
                        });
                        section.classList.remove('collapsed');
                        section.classList.add('expanded');
                    } else {
                        section.classList.remove('expanded');
                        section.classList.add('collapsed');
                    }
                    
                    setTimeout(() => {
                        setupAutoResizeTextareas();
                    }, 100);
                });
                
                container.appendChild(sectionElement);
            });
        }
        
        // Сохранить ответ
        function saveAnswer(sectionIndex, questionIndex, answer, comment = null, additionalInfo = null) {
            if (!answers[sectionIndex]) {
                answers[sectionIndex] = {};
            }
            
            if (!answers[sectionIndex][questionIndex]) {
                answers[sectionIndex][questionIndex] = {};
            }
            
            if (answer !== null) {
                answers[sectionIndex][questionIndex].answer = answer;
            }
            
            if (comment !== null) {
                answers[sectionIndex][questionIndex].comment = comment;
            }
            
            if (additionalInfo !== null) {
                answers[sectionIndex][questionIndex].additionalInfo = additionalInfo;
            }
        }
        
        // Обновить статус секции
        function updateSectionStatus(sectionIndex) {
            const section = document.querySelector(`.section[data-section-index="${sectionIndex}"]`);
            const statusElement = section.querySelector('.section-status');
            
            const totalQuestions = sections[sectionIndex].questions.length;
            const answeredQuestions = section.querySelectorAll('.check-button.checked').length;
            
            statusElement.textContent = `${answeredQuestions}/${totalQuestions}`;
        }
        
        // Обновить прогресс-бар
        function updateProgressBar() {
            const progressBar = document.getElementById('progress');
            
            let totalQuestions = 0;
            let answeredQuestions = 0;
            
            sections.forEach((section, index) => {
                totalQuestions += section.questions.length;
                
                if (answers[index]) {
                    answeredQuestions += Object.keys(answers[index]).length;
                }
            });
            
            const progressPercentage = (answeredQuestions / totalQuestions) * 100;
            progressBar.style.width = `${progressPercentage}%`;
        }
        
        // Сохранить в LocalStorage
        function saveToLocalStorage(silent = false) {
            const timestamp = document.getElementById('timestamp').value;
            const data = {
                timestamp: timestamp,
                answers: answers,
                lastSaved: new Date().toLocaleString('ru-RU')
            };
            
            localStorage.setItem('medical_checklist_data', JSON.stringify(data));
            lastSaveTime = new Date();
            
            if (!silent) {
                alert('Данные сохранены в браузере!');
            }
            
            updateAutoSaveStatus();
        }
        
        // Обновить статус автосохранения
        function updateAutoSaveStatus() {
            const statusElement = document.getElementById('auto-save-status');
            if (lastSaveTime) {
                const timeString = lastSaveTime.toLocaleTimeString('ru-RU', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                statusElement.textContent = `Сохранено: ${timeString}`;
            }
        }
        
        // Загрузить из LocalStorage
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('medical_checklist_data');
            if (savedData) {
                const data = JSON.parse(savedData);
                answers = data.answers || {};
                
                Object.keys(answers).forEach(sectionIndex => {
                    Object.keys(answers[sectionIndex]).forEach(questionIndex => {
                        const answerData = answers[sectionIndex][questionIndex];
                        const questionElement = document.querySelector(`[data-question-id="${sectionIndex}-${questionIndex}"]`);
                        
                        if (questionElement && answerData.answer === 'Проверено') {
                            const checkButton = questionElement.querySelector('.check-button');
                            if (checkButton) {
                                checkButton.classList.add('checked');
                                questionElement.classList.add('completed');
                            }
                            
                            if (answerData.comment) {
                                const comment = questionElement.querySelector('.comment');
                                if (comment) {
                                    comment.value = answerData.comment;
                                }
                            }
                            
                            if (answerData.additionalInfo) {
                                const additionalInfo = questionElement.querySelector('.additional-info');
                                if (additionalInfo) {
                                    additionalInfo.value = answerData.additionalInfo;
                                }
                            }
                        }
                    });
                    updateSectionStatus(parseInt(sectionIndex));
                });
                
                updateProgressBar();
                updateAutoSaveStatus();
                
                setTimeout(() => {
                    setupAutoResizeTextareas();
                }, 100);
            }
        }
        
        // Очистить форму
        function clearForm() {
            if (confirm('Вы уверены, что хотите очистить всю форму? Все данные будут удалены.')) {
                answers = {};
                localStorage.removeItem('medical_checklist_data');
                
                document.querySelectorAll('.question').forEach(question => {
                    question.classList.remove('completed');
                    const checkButtons = question.querySelectorAll('.check-button');
                    checkButtons.forEach(button => button.classList.remove('checked'));
                    
                    const textareas = question.querySelectorAll('textarea');
                    textareas.forEach(textarea => {
                        textarea.value = '';
                        textarea.style.height = '60px';
                    });
                });
                
                document.querySelectorAll('.section-status').forEach(status => {
                    const sectionIndex = status.closest('.section').dataset.sectionIndex;
                    status.textContent = `0/${sections[sectionIndex].questions.length}`;
                });
                
                updateProgressBar();
                updateAutoSaveStatus();
                
                alert('Форма очищена!');
            }
        }
        
        // Экспорт в Excel - ИСПРАВЛЕННАЯ ВЕРСИЯ
        function exportToExcel() {
            try {
                const timestamp = document.getElementById('timestamp').value;
                let dateStr;
                
                if (timestamp) {
                    const date = new Date(timestamp);
                    const day = String(date.getDate()).padStart(2, '0');
                    const month = String(date.getMonth() + 1).padStart(2, '0');
                    const year = date.getFullYear();
                    dateStr = `${day}.${month}.${year}`;
                } else {
                    const now = new Date();
                    dateStr = `${String(now.getDate()).padStart(2, '0')}.${String(now.getMonth() + 1).padStart(2, '0')}.${now.getFullYear()}`;
                }
                
                // Создаем HTML таблицу для Excel
                let htmlContent = `
                    <html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel">
                    <head>
                        <meta charset="UTF-8">
                        <!--[if gte mso 9]>
                        <xml>
                            <x:ExcelWorkbook>
                                <x:ExcelWorksheets>
                                    <x:ExcelWorksheet>
                                        <x:Name>Анкета обхода</x:Name>
                                        <x:WorksheetOptions>
                                            <x:DisplayGridlines/>
                                        </x:WorksheetOptions>
                                    </x:ExcelWorksheet>
                                </x:ExcelWorksheets>
                            </x:ExcelWorkbook>
                        </xml>
                        <![endif]-->
                        <style>
                            table { border-collapse: collapse; width: 100%; }
                            th, td { border: 1px solid black; padding: 5px; }
                            th { background-color: #f2f2f2; font-weight: bold; }
                            .header { font-size: 16px; font-weight: bold; }
                            .section-header { background-color: #e0e0e0; font-weight: bold; }
                        </style>
                    </head>
                    <body>
                        <table>
                            <tr><td colspan="5" class="header">Анкета административно-хозяйственного обхода с заведующим хозяйством</td></tr>
                            <tr><td colspan="5">ГБУЗ МО МОКПТД</td></tr>
                            <tr><td colspan="5">Филиал "Клинский"</td></tr>
                            <tr><td colspan="5">Клинское отделение</td></tr>
                            <tr><td colspan="5">Дата проверки: ${dateStr}</td></tr>
                            <tr><td colspan="5">Дата формирования отчета: ${new Date().toLocaleString('ru-RU')}</td></tr>
                            <tr><td colspan="5"></td></tr>
                `;
                
                // Добавляем данные по секциям
                sections.forEach((section, sectionIndex) => {
                    htmlContent += `
                        <tr><td colspan="5" class="section-header">${sectionIndex + 1}. ${section.title}</td></tr>
                        <tr>
                            <th width="50">№</th>
                            <th width="400">Вопрос</th>
                            <th width="100">Статус</th>
                            <th width="200">Комментарий</th>
                            <th width="200">Дополнительная информация</th>
                        </tr>
                    `;
                    
                    section.questions.forEach((question, questionIndex) => {
                        const answerData = answers[sectionIndex] && answers[sectionIndex][questionIndex];
                        const answer = answerData && answerData.answer ? answerData.answer : 'Не проверено';
                        const comment = answerData && answerData.comment ? answerData.comment : '';
                        const additionalInfo = answerData && answerData.additionalInfo ? answerData.additionalInfo : '';
                        
                        htmlContent += `
                            <tr>
                                <td>${questionIndex + 1}</td>
                                <td>${question}</td>
                                <td>${answer}</td>
                                <td>${comment}</td>
                                <td>${additionalInfo}</td>
                            </tr>
                        `;
                    });
                    
                    htmlContent += `<tr><td colspan="5"></td></tr>`;
                });
                
                htmlContent += `
                        </table>
                    </body>
                    </html>
                `;
                
                // Создаем blob и ссылку для скачивания
                const blob = new Blob([htmlContent], { type: 'application/vnd.ms-excel' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `анкета_хозяйственного_обхода_${dateStr.replace(/\./g, '-')}.xls`;
                
                // Добавляем ссылку в документ и кликаем по ней
                document.body.appendChild(link);
                link.click();
                
                // Очищаем
                setTimeout(() => {
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                }, 100);
                
                // Обновляем статус
                const statusElement = document.getElementById('auto-save-status');
                const now = new Date().toLocaleTimeString('ru-RU', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                statusElement.textContent = `Экспортировано: ${now}`;
                
            } catch (error) {
                console.error('Ошибка при экспорте:', error);
                alert('Произошла ошибка при создании Excel файла. Пожалуйста, попробуйте еще раз.');
            }
        }
    </script>
</body>
</html>
